{{define "slime_detail.html"}}
{{template "layout.html" .}}
{{end}}

{{define "content"}}
<!-- Header -->
<div style="display: flex; align-items: center; gap: 20px; margin-bottom: 24px; background: rgba(255,255,255,0.02); border-radius: 12px; padding: 20px;">
  <div style="flex-shrink: 0; background: rgba(255,255,255,0.04); border-radius: 16px; padding: 12px;">
    <img src="/admin/slime-icon/{{.Species.ID}}?element={{.Species.Element}}&grade={{.Species.Grade}}" width="100" height="100" alt="{{.Species.Name}}" />
  </div>
  <div style="flex: 1;">
    <div style="display: flex; align-items: center; gap: 10px; margin-bottom: 4px;">
      <span style="font-size: 13px; color: #636e72;">#{{.Species.ID}}</span>
      <span class="badge badge-{{.Species.Grade}}" style="font-size: 12px; padding: 3px 10px;">{{.Species.Grade}}</span>
      {{if .IsStarter}}<span style="font-size: 11px; padding: 3px 8px; border-radius: 4px; background: #00b894; color: white;">ìŠ¤íƒ€í„°</span>{{end}}
    </div>
    <div style="font-size: 24px; font-weight: 700; color: #e8e4f0; margin-bottom: 2px;">{{.Species.Name}}</div>
    <div style="font-size: 14px; color: #b2bec3;">{{.Species.NameEN}}</div>
    {{if .Species.Description}}
    <div style="font-size: 13px; color: #a0a8b0; margin-top: 10px; line-height: 1.6; max-width: 500px;">{{.Species.Description}}</div>
    {{end}}
  </div>
</div>

<!-- ê¸°ë³¸ ì •ë³´ -->
<div class="stats-grid" style="grid-template-columns: repeat(5, 1fr); margin-bottom: 20px;">
  <div class="stat-card">
    <div class="label">ì†ì„±</div>
    <div class="value" style="font-size: 16px;">
      {{if eq .Species.Element "water"}}ğŸ’§{{else if eq .Species.Element "fire"}}ğŸ”¥{{else if eq .Species.Element "grass"}}ğŸŒ¿{{else if eq .Species.Element "light"}}âœ¨{{else if eq .Species.Element "dark"}}ğŸŒ‘{{else if eq .Species.Element "ice"}}â„ï¸{{else if eq .Species.Element "electric"}}âš¡{{else if eq .Species.Element "poison"}}â˜ ï¸{{else if eq .Species.Element "earth"}}ğŸª¨{{else if eq .Species.Element "wind"}}ğŸŒªï¸{{else if eq .Species.Element "celestial"}}ğŸŒŸ{{end}}
      {{.Species.Element}}
    </div>
  </div>
  <div class="stat-card">
    <div class="label">ë“±ê¸‰</div>
    <div class="value"><span class="badge badge-{{.Species.Grade}}">{{.Species.Grade}}</span></div>
  </div>
  <div class="stat-card">
    <div class="label">ì§„ì˜</div>
    <div class="value" style="font-size: 13px;">
      {{if .Faction.Name}}{{.Faction.Name}}{{else}}-{{end}}
    </div>
    <div style="font-size: 11px; color: #636e72; margin-top: 2px;">{{.Faction.NameEN}}</div>
  </div>
  <div class="stat-card">
    <div class="label">ì§„ì˜ ë‚´ ìœ„ì¹˜</div>
    <div class="value" style="font-size: 16px; color: #74b9ff;">{{.PositionInFaction}} / {{.Faction.Count}}</div>
  </div>
  <div class="stat-card">
    <div class="label">ì»¬ë ‰ì…˜ í•„ìš” ë ˆë²¨</div>
    <div class="value" style="font-size: 20px; color: #fdcb6e;">Lv.{{.RequiredLevel}}</div>
    <div style="font-size: 11px; color: #636e72; margin-top: 2px;">6ì„±ê²© = 6ì—”íŠ¸ë¦¬</div>
  </div>
</div>

<!-- ì„±ê²© & ì»¬ë ‰ì…˜ ì •ë³´ -->
<div style="display: grid; grid-template-columns: 1fr 1fr; gap: 16px; margin-bottom: 20px;">

  <!-- íšë“ ë°©ë²• -->
  <div class="stat-card">
    <div class="label" style="margin-bottom: 12px; font-size: 14px; color: #55efc4;">íšë“ ë°©ë²•</div>
    {{if .IsStarter}}
    <div style="display: flex; align-items: center; gap: 8px; padding: 8px 0; border-bottom: 1px solid rgba(255,255,255,0.06);">
      <span style="font-size: 18px;">ğŸ</span>
      <div>
        <div style="font-size: 13px; color: #dfe6e9; font-weight: 600;">ìŠ¤íƒ€í„° ìŠ¬ë¼ì„</div>
        <div style="font-size: 11px; color: #636e72;">ì‹ ê·œ ìœ ì € ì‹œì‘ ì‹œ ì§€ê¸‰</div>
      </div>
    </div>
    {{end}}
    {{if .EggInfo}}
    <div style="font-size: 12px; color: #b2bec3; margin-bottom: 8px; {{if .IsStarter}}margin-top: 12px;{{end}}">ë½‘ê¸° (ê°€ì± )</div>
    {{range .EggInfo}}
    <div style="display: flex; align-items: center; gap: 8px; padding: 5px 0;">
      <span style="font-size: 14px;">ğŸ¥š</span>
      <span style="font-size: 13px; color: #dfe6e9;">{{.}}</span>
    </div>
    {{end}}
    {{end}}
    {{if .Recipes}}
    <div style="font-size: 12px; color: #b2bec3; margin-top: 12px; margin-bottom: 6px;">í•©ì„± ë ˆì‹œí”¼</div>
    {{range .Recipes}}
    {{if eq .Role "ê²°ê³¼ë¬¼"}}
    <div style="padding: 8px; margin-bottom: 6px; background: rgba(255,255,255,0.03); border-radius: 6px;">
      <div style="display: flex; align-items: center; gap: 6px; font-size: 13px;">
        <a href="/admin/slimes/{{.InputAID}}" style="color: #74b9ff; text-decoration: none;">{{.InputAName}}</a>
        <span style="color: #636e72;">+</span>
        <a href="/admin/slimes/{{.InputBID}}" style="color: #74b9ff; text-decoration: none;">{{.InputBName}}</a>
        <span style="color: #636e72;">=</span>
        <span style="color: #55efc4; font-weight: 600;">ê²°ê³¼</span>
      </div>
      {{if .Hidden}}<span style="font-size: 10px; padding: 1px 5px; border-radius: 3px; background: #6c5ce7; color: white; margin-top: 4px; display: inline-block;">íˆë“ </span>{{end}}
      {{if .Hint}}<div style="font-size: 11px; color: #636e72; margin-top: 4px; font-style: italic;">{{.Hint}}</div>{{end}}
    </div>
    {{end}}
    {{end}}
    {{end}}
    {{if and (not .IsStarter) (not .EggInfo) (not .Recipes)}}
    <div style="color: #636e72; font-size: 13px; padding: 12px 0;">ë³„ë„ íšë“ ê²½ë¡œ ì—†ìŒ</div>
    {{end}}
  </div>

  <!-- ê´€ë ¨ ë ˆì‹œí”¼ (ì´ ì¢…ì¡±ì´ ì¬ë£Œì¸ ê²½ìš°) -->
  <div class="stat-card">
    <div class="label" style="margin-bottom: 12px; font-size: 14px; color: #fd79a8;">ë ˆì‹œí”¼ ì°¸ì—¬</div>
    {{$hasInputRecipe := false}}
    {{range .Recipes}}
    {{if or (eq .Role "ì¬ë£Œ A") (eq .Role "ì¬ë£Œ B")}}
    {{$hasInputRecipe = true}}
    <div style="padding: 8px; margin-bottom: 6px; background: rgba(255,255,255,0.03); border-radius: 6px;">
      <div style="display: flex; align-items: center; gap: 6px; font-size: 13px; flex-wrap: wrap;">
        {{if eq .Role "ì¬ë£Œ A"}}
        <span style="color: #fdcb6e; font-weight: 600;">ì´ ì¢…ì¡±</span>
        <span style="color: #636e72;">+</span>
        <a href="/admin/slimes/{{.InputBID}}" style="color: #74b9ff; text-decoration: none;">{{.InputBName}}</a>
        {{else}}
        <a href="/admin/slimes/{{.InputAID}}" style="color: #74b9ff; text-decoration: none;">{{.InputAName}}</a>
        <span style="color: #636e72;">+</span>
        <span style="color: #fdcb6e; font-weight: 600;">ì´ ì¢…ì¡±</span>
        {{end}}
        <span style="color: #636e72;">&rarr;</span>
        <a href="/admin/slimes/{{.OutputID}}" style="color: #55efc4; text-decoration: none; font-weight: 600;">{{.OutputName}}</a>
      </div>
      {{if .Hidden}}<span style="font-size: 10px; padding: 1px 5px; border-radius: 3px; background: #6c5ce7; color: white; margin-top: 4px; display: inline-block;">íˆë“ </span>{{end}}
      {{if .Hint}}<div style="font-size: 11px; color: #636e72; margin-top: 4px; font-style: italic;">{{.Hint}}</div>{{end}}
    </div>
    {{end}}
    {{end}}
    {{if not $hasInputRecipe}}
    <div style="color: #636e72; font-size: 13px; padding: 12px 0;">ì´ ì¢…ì¡±ì´ ì¬ë£Œë¡œ ì‚¬ìš©ë˜ëŠ” ë ˆì‹œí”¼ ì—†ìŒ</div>
    {{end}}
  </div>
</div>

<!-- ì§„ì˜ ë™ë£Œ -->
<div class="stat-card" style="margin-bottom: 20px;">
  <div class="label" style="margin-bottom: 12px; font-size: 14px; color: #74b9ff;">
    {{.Faction.Name}} ì§„ì˜ ({{.Faction.Count}}ì¢…)
    <span style="font-size: 11px; color: #636e72; font-weight: 400; margin-left: 8px;">#{{.Faction.RangeStart}} ~ #{{.Faction.RangeEnd}}</span>
  </div>
  <div style="display: flex; flex-wrap: wrap; gap: 6px;">
    {{range .Faction.Members}}
    <a href="/admin/slimes/{{.ID}}" style="display: inline-flex; align-items: center; gap: 4px; padding: 4px 10px; border-radius: 6px; font-size: 12px; text-decoration: none; {{if eq .ID $.Species.ID}}background: rgba(116,185,255,0.2); color: #74b9ff; font-weight: 700; border: 1px solid rgba(116,185,255,0.3);{{else}}background: rgba(255,255,255,0.04); color: #b2bec3; border: 1px solid rgba(255,255,255,0.06);{{end}}">
      <img src="/admin/slime-icon/{{.ID}}?element={{.Element}}&grade={{.Grade}}" width="20" height="20" alt="" style="vertical-align: middle;" />
      {{.Name}}
    </a>
    {{end}}
  </div>
</div>

<!-- ê°™ì€ ì†ì„± & ê°™ì€ ë“±ê¸‰ -->
<div style="display: grid; grid-template-columns: 1fr 1fr; gap: 16px; margin-bottom: 20px;">
  <div class="stat-card">
    <div class="label" style="margin-bottom: 10px; font-size: 14px;">
      {{if eq .Species.Element "water"}}ğŸ’§{{else if eq .Species.Element "fire"}}ğŸ”¥{{else if eq .Species.Element "grass"}}ğŸŒ¿{{else if eq .Species.Element "light"}}âœ¨{{else if eq .Species.Element "dark"}}ğŸŒ‘{{else if eq .Species.Element "ice"}}â„ï¸{{else if eq .Species.Element "electric"}}âš¡{{else if eq .Species.Element "poison"}}â˜ ï¸{{else if eq .Species.Element "earth"}}ğŸª¨{{else if eq .Species.Element "wind"}}ğŸŒªï¸{{else if eq .Species.Element "celestial"}}ğŸŒŸ{{end}}
      ê°™ì€ ì†ì„± ({{.Species.Element}}) â€” {{.TotalSameElement}}ì¢…
    </div>
    <div style="display: flex; flex-wrap: wrap; gap: 4px;">
      {{range .SameElement}}
      <a href="/admin/slimes/{{.ID}}" style="display: inline-flex; align-items: center; gap: 4px; padding: 3px 8px; border-radius: 4px; font-size: 11px; text-decoration: none; background: rgba(255,255,255,0.04); color: #b2bec3; border: 1px solid rgba(255,255,255,0.06);">
        <img src="/admin/slime-icon/{{.ID}}?element={{$.Species.Element}}&grade={{.Grade}}" width="16" height="16" alt="" />
        {{.Name}}
      </a>
      {{else}}
      <span style="color: #636e72; font-size: 12px;">ì—†ìŒ</span>
      {{end}}
    </div>
  </div>
  <div class="stat-card">
    <div class="label" style="margin-bottom: 10px; font-size: 14px;">
      <span class="badge badge-{{.Species.Grade}}" style="font-size: 10px; padding: 2px 6px;">{{.Species.Grade}}</span>
      ê°™ì€ ë“±ê¸‰ â€” {{.TotalSameGrade}}ì¢…
    </div>
    <div style="display: flex; flex-wrap: wrap; gap: 4px;">
      {{range .SameGrade}}
      <a href="/admin/slimes/{{.ID}}" style="padding: 3px 8px; border-radius: 4px; font-size: 11px; text-decoration: none; background: rgba(255,255,255,0.04); color: #b2bec3; border: 1px solid rgba(255,255,255,0.06);">
        {{.Name}}
      </a>
      {{else}}
      <span style="color: #636e72; font-size: 12px;">ì—†ìŒ</span>
      {{end}}
    </div>
  </div>
</div>

<!-- Navigation -->
<div style="display: flex; justify-content: space-between; align-items: center; margin-top: 8px;">
  <a href="/admin/slimes" class="btn btn-sm" style="background: rgba(255,255,255,0.06); color: #b2bec3;">&larr; ìŠ¬ë¼ì„ ëª©ë¡</a>
  <div style="display: flex; gap: 8px;">
    {{if .PrevID}}<a href="/admin/slimes/{{.PrevID}}" class="btn btn-sm" style="background: rgba(255,255,255,0.06); color: #b2bec3;">&laquo; #{{.PrevID}}</a>{{end}}
    {{if .NextID}}<a href="/admin/slimes/{{.NextID}}" class="btn btn-sm" style="background: rgba(255,255,255,0.06); color: #b2bec3;">#{{.NextID}} &raquo;</a>{{end}}
  </div>
</div>
{{end}}
