{{define "logs_currency.html"}}
{{template "layout.html" .}}
{{end}}

{{define "content"}}
<form class="filter-bar" method="GET" action="/admin/logs/currency">
  <input type="text" name="search" placeholder="닉네임 검색..." value="{{.Search}}" style="width:180px;">
  <input type="date" name="date_from" value="{{.DateFrom}}" style="width:150px;">
  <span style="color:#636e72;">~</span>
  <input type="date" name="date_to" value="{{.DateTo}}" style="width:150px;">
  <input type="text" name="action" placeholder="action 필터" value="{{.Action}}" style="width:140px;">
  <button type="submit" class="btn btn-primary btn-sm">검색</button>
  <span style="color:#636e72; font-size:12px; margin-left:8px;">총 {{.TotalCount}}건</span>
</form>

{{if .Error}}<div class="msg-error">{{.Error}}</div>{{end}}

<table>
  <thead>
    <tr>
      <th>시간</th>
      <th>닉네임</th>
      <th>액션</th>
      <th>골드</th>
      <th>젬</th>
      <th>별가루</th>
      <th>상세</th>
    </tr>
  </thead>
  <tbody>
    {{range .Logs}}
    <tr>
      <td style="font-size:11px; color:#636e72;">{{formatDate .CreatedAt}}</td>
      <td>{{.Nickname}}</td>
      <td><span class="badge" style="background:rgba(116,185,255,0.15); color:#74b9ff;">{{.Action}}</span></td>
      <td style="color:{{if gt .GoldDelta 0}}#55efc4{{else if lt .GoldDelta 0}}#ff6b6b{{else}}#636e72{{end}}; font-weight:600;">
        {{if gt .GoldDelta 0}}+{{end}}{{.GoldDelta}}
      </td>
      <td style="color:{{if gt .GemsDelta 0}}#55efc4{{else if lt .GemsDelta 0}}#ff6b6b{{else}}#636e72{{end}}; font-weight:600;">
        {{if gt .GemsDelta 0}}+{{end}}{{.GemsDelta}}
      </td>
      <td style="color:{{if gt .StardustDelta 0}}#55efc4{{else if lt .StardustDelta 0}}#ff6b6b{{else}}#636e72{{end}}; font-weight:600;">
        {{if gt .StardustDelta 0}}+{{end}}{{.StardustDelta}}
      </td>
      <td style="font-size:11px; max-width:300px; overflow:hidden; text-overflow:ellipsis; white-space:nowrap;">{{truncate .Detail 80}}</td>
    </tr>
    {{else}}
    <tr><td colspan="7" style="text-align:center; color:#636e72;">데이터 없음</td></tr>
    {{end}}
  </tbody>
</table>

{{template "log_pagination" .}}
{{end}}

{{define "log_pagination"}}
<div class="pagination">
  {{if .HasPrev}}<a href="?page={{.PrevPage}}&search={{.Search}}&date_from={{.DateFrom}}&date_to={{.DateTo}}&action={{.Action}}">이전</a>{{end}}
  <span class="current">{{.Page}} / {{.TotalPages}}</span>
  {{if .HasNext}}<a href="?page={{.NextPage}}&search={{.Search}}&date_from={{.DateFrom}}&date_to={{.DateTo}}&action={{.Action}}">다음</a>{{end}}
</div>
{{end}}
