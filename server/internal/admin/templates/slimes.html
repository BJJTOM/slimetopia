{{define "slimes.html"}}
{{template "layout.html" .}}
{{end}}

{{define "content"}}
{{if .Error}}
<div class="msg-error">{{.Error}}</div>
{{end}}

<!-- Search & Filters -->
<form class="filter-bar" method="GET" action="/admin/slimes">
  <input type="text" name="search" placeholder="ì´ë¦„ìœ¼ë¡œ ê²€ìƒ‰..." value="{{.Search}}" style="width: 200px;" />
  <select name="faction" style="width: 140px;">
    <option value="">ì „ì²´ ì§„ì˜</option>
    <option value="east_blue" {{if eq .Faction "east_blue"}}selected{{end}}>ì´ìŠ¤íŠ¸ ë¸”ë£¨</option>
    <option value="grand_line" {{if eq .Faction "grand_line"}}selected{{end}}>ê·¸ëœë“œ ë¼ì¸</option>
    <option value="straw_hat" {{if eq .Faction "straw_hat"}}selected{{end}}>ë°€ì§šëª¨ì</option>
    <option value="baroque" {{if eq .Faction "baroque"}}selected{{end}}>ë°”ë¡œí¬ ì›Œí¬ìŠ¤</option>
    <option value="sky_island" {{if eq .Faction "sky_island"}}selected{{end}}>ìŠ¤ì¹´ì´ ì•„ì¼ëœë“œ</option>
    <option value="cipher_pol" {{if eq .Faction "cipher_pol"}}selected{{end}}>ì‚¬ì´í¼ í´</option>
    <option value="warlords" {{if eq .Faction "warlords"}}selected{{end}}>ì¹ ë¬´í•´</option>
    <option value="worst_gen" {{if eq .Faction "worst_gen"}}selected{{end}}>ìµœì•…ì˜ ì„¸ëŒ€</option>
    <option value="marines" {{if eq .Faction "marines"}}selected{{end}}>í•´êµ°</option>
    <option value="yonko" {{if eq .Faction "yonko"}}selected{{end}}>ì‚¬í™©</option>
    <option value="logia" {{if eq .Faction "logia"}}selected{{end}}>ìì—°ê³„</option>
    <option value="paramecia" {{if eq .Faction "paramecia"}}selected{{end}}>ì´ˆì¸ê³„</option>
    <option value="zoan" {{if eq .Faction "zoan"}}selected{{end}}>ë™ë¬¼ê³„</option>
    <option value="revolutionary" {{if eq .Faction "revolutionary"}}selected{{end}}>í˜ëª…êµ°</option>
    <option value="celestial" {{if eq .Faction "celestial"}}selected{{end}}>ì²œë£¡ì¸</option>
    <option value="hidden" {{if eq .Faction "hidden"}}selected{{end}}>íˆë“ </option>
  </select>
  <select name="element" style="width: 120px;">
    <option value="">ì „ì²´ ì†ì„±</option>
    <option value="water" {{if eq .Element "water"}}selected{{end}}>ğŸ’§ water</option>
    <option value="fire" {{if eq .Element "fire"}}selected{{end}}>ğŸ”¥ fire</option>
    <option value="grass" {{if eq .Element "grass"}}selected{{end}}>ğŸŒ¿ grass</option>
    <option value="light" {{if eq .Element "light"}}selected{{end}}>âœ¨ light</option>
    <option value="dark" {{if eq .Element "dark"}}selected{{end}}>ğŸŒ‘ dark</option>
    <option value="ice" {{if eq .Element "ice"}}selected{{end}}>â„ï¸ ice</option>
    <option value="electric" {{if eq .Element "electric"}}selected{{end}}>âš¡ electric</option>
    <option value="poison" {{if eq .Element "poison"}}selected{{end}}>â˜ ï¸ poison</option>
    <option value="earth" {{if eq .Element "earth"}}selected{{end}}>ğŸª¨ earth</option>
    <option value="wind" {{if eq .Element "wind"}}selected{{end}}>ğŸŒªï¸ wind</option>
    <option value="celestial" {{if eq .Element "celestial"}}selected{{end}}>ğŸŒŸ celestial</option>
  </select>
  <select name="grade" style="width: 120px;">
    <option value="">ì „ì²´ ë“±ê¸‰</option>
    <option value="common" {{if eq .Grade "common"}}selected{{end}}>Common</option>
    <option value="uncommon" {{if eq .Grade "uncommon"}}selected{{end}}>Uncommon</option>
    <option value="rare" {{if eq .Grade "rare"}}selected{{end}}>Rare</option>
    <option value="epic" {{if eq .Grade "epic"}}selected{{end}}>Epic</option>
    <option value="legendary" {{if eq .Grade "legendary"}}selected{{end}}>Legendary</option>
    <option value="mythic" {{if eq .Grade "mythic"}}selected{{end}}>Mythic</option>
  </select>
  <button type="submit" class="btn btn-primary">ê²€ìƒ‰</button>
  {{if or .Search .Grade .Element .Faction}}<a href="/admin/slimes" class="btn btn-danger btn-sm">ì´ˆê¸°í™”</a>{{end}}
</form>

<p style="font-size: 12px; color: #636e72; margin-bottom: 12px;">ì´ {{.TotalCount}}ì¢…</p>

<table>
  <thead>
    <tr>
      <th style="width: 50px;"></th>
      <th style="width: 50px;">ID</th>
      <th>ì´ë¦„</th>
      <th>ì˜ë¬¸ëª…</th>
      <th style="width: 90px;">ì†ì„±</th>
      <th style="width: 90px;">ë“±ê¸‰</th>
      <th style="width: 110px;">ì§„ì˜</th>
      <th>ì„¤ëª…</th>
    </tr>
  </thead>
  <tbody>
    {{range .Slimes}}
    <tr onclick="location.href='/admin/slimes/{{.ID}}'" style="cursor: pointer;">
      <td style="padding: 4px 8px;"><img src="/admin/slime-icon/{{.ID}}?element={{.Element}}&grade={{.Grade}}" width="40" height="40" alt="" /></td>
      <td style="color: #636e72; font-size: 12px;">{{.ID}}</td>
      <td style="font-weight: 600;">{{.Name}}</td>
      <td style="color: #b2bec3; font-size: 12px;">{{.NameEN}}</td>
      <td>
        <span style="font-size: 12px;">
        {{if eq .Element "water"}}ğŸ’§{{else if eq .Element "fire"}}ğŸ”¥{{else if eq .Element "grass"}}ğŸŒ¿{{else if eq .Element "light"}}âœ¨{{else if eq .Element "dark"}}ğŸŒ‘{{else if eq .Element "ice"}}â„ï¸{{else if eq .Element "electric"}}âš¡{{else if eq .Element "poison"}}â˜ ï¸{{else if eq .Element "earth"}}ğŸª¨{{else if eq .Element "wind"}}ğŸŒªï¸{{else if eq .Element "celestial"}}ğŸŒŸ{{end}}
        {{.Element}}</span>
      </td>
      <td><span class="badge badge-{{.Grade}}">{{.Grade}}</span></td>
      <td>
        {{if .Faction}}<span style="font-size: 11px; padding: 2px 6px; border-radius: 4px; background: #2d3436; color: #dfe6e9;">{{.Faction}}</span>{{end}}
      </td>
      <td style="color: #b2bec3; font-size: 11px; max-width: 280px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;">{{truncate .Description 40}}</td>
    </tr>
    {{else}}
    <tr><td colspan="8" style="text-align:center; color:#636e72; padding: 24px;">ìŠ¬ë¼ì„ ë°ì´í„° ì—†ìŒ</td></tr>
    {{end}}
  </tbody>
</table>

{{if gt .TotalPages 1}}
<div class="pagination">
  {{if .HasPrev}}<a href="/admin/slimes?page={{.PrevPage}}&search={{.Search}}&grade={{.Grade}}&element={{.Element}}&faction={{.Faction}}" class="btn btn-sm">&laquo; ì´ì „</a>{{end}}
  <span class="current">{{.Page}} / {{.TotalPages}}</span>
  {{if .HasNext}}<a href="/admin/slimes?page={{.NextPage}}&search={{.Search}}&grade={{.Grade}}&element={{.Element}}&faction={{.Faction}}" class="btn btn-sm">ë‹¤ìŒ &raquo;</a>{{end}}
</div>
{{end}}
{{end}}
